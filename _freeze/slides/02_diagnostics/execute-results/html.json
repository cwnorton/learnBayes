{
  "hash": "404d0003c8bf0de6f6b29b8120e91982",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Bayesian Linear Models\"\nsubtitle: \"02 - Diagnostics\"\nauthor: \"Stefano Coretta\"\ninstitute: \"University of Edinburgh\"\neditor: source\nformat:\n  mono-light-revealjs:\n    theme: [default, custom.scss]\n    history: false\nfilters:\n  - tachyonsextra\nexecute: \n  echo: true\n---\n\n\n\n\n## MCMC traces\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(brm_2)\n```\n\n::: {.cell-output-display}\n![](02_diagnostics_files/figure-revealjs/brm-2-plot-1.png){width=960}\n:::\n:::\n\n\n## MCMC traces: bad\n\nAn example of bad MCMC chain mixing.\n\n![](/img/trace_c.png){fig-align=\"center\"}\n\n::: notes\nPicture from <https://www.rdatagen.net/post/diagnosing-and-dealing-with-estimation-issues-in-the-bayesian-meta-analysis/>.\n:::\n\n## MCMC traces: intercept\n\n\n::: {.cell}\n\n```{.r .cell-code}\nas.array(brm_2) %>%\n  mcmc_trace(\"b_Intercept\", np = nuts_params(brm_2))\n```\n\n::: {.cell-output-display}\n![](02_diagnostics_files/figure-revealjs/brm-2-trace-int-1.png){width=960}\n:::\n:::\n\n\n## MCMC traces: `IsWord`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nas.array(brm_2) %>%\n  mcmc_trace(\"b_IsWordFALSE\", np = nuts_params(brm_2))\n```\n\n::: {.cell-output-display}\n![](02_diagnostics_files/figure-revealjs/brm-2-trace-isword-1.png){width=960}\n:::\n:::\n\n\n## $\\hat{R}$ and Effective Sample Size (ESS)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrm_2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: RT ~ IsWord \n   Data: mald (Number of observations: 3000) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept     981.35      8.73   964.38   998.37 1.00     3970     3032\nIsWordFALSE   132.87     12.63   107.91   156.87 1.00     3936     2937\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma   341.21      4.48   332.33   349.82 1.00     4223     3006\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n\n\n:::\n:::\n\n\n## Posterior Predictive Checks\n\n\n::: {.cell}\n\n```{.r .cell-code}\npp_check(brm_2, ndraws = 20)\n```\n\n::: {.cell-output-display}\n![](02_diagnostics_files/figure-revealjs/brm-2-pp-1.png){width=960}\n:::\n:::\n\n\n## Summary\n\n::: box-tip\nQuick and dirty diagnostics:\n\n- MCMC traces: hairy caterpillars, no divergent transitions.\n\n- $\\hat{R}: should be as close to 1 as possible.\n\n- Effective Sample Size (ESS): should be large enough.\n\n- Posterior Predictive Checks: predicted outcome distribution should match the empirical distribution.\n:::\n\n. . .\n\n::: box-warning\n- `brm()` warns you about divergent transition, $\\hat{R} > 1$ and low ESS.\n\n- Posterior predictive checks are based on visual inspection only.\n:::\n",
    "supporting": [
      "02_diagnostics_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}